(function(e){function t(t){for(var i,o,r=t[0],l=t[1],c=t[2],u=0,d=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&d.push(n[o][0]),n[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);m&&m(t);while(d.length)d.shift()();return a.push.apply(a,c||[]),s()}function s(){for(var e,t=0;t<a.length;t++){for(var s=a[t],i=!0,o=1;o<s.length;o++){var r=s[o];0!==n[r]&&(i=!1)}i&&(a.splice(t--,1),e=l(l.s=s[0]))}return e}var i={},o={app:0},n={app:0},a=[];function r(e){return l.p+"js/"+({}[e]||e)+"."+{"chunk-14956146":"9941c8c3","chunk-3a1e6ecc":"c9795d0a","chunk-3b5de258":"ae6e1142","chunk-66aa74b7":"099967e3","chunk-66e337bf":"08e9a4b1","chunk-6db636c9":"7ff17cec","chunk-77a4b6a4":"ea16e83a","chunk-bef26562":"1593da61","chunk-ca5cf8a6":"0eb3b98c","chunk-0956a750":"fc097226","chunk-1f7abdbb":"514abce8"}[e]+".js"}function l(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,l),s.l=!0,s.exports}l.e=function(e){var t=[],s={"chunk-14956146":1,"chunk-3a1e6ecc":1,"chunk-3b5de258":1,"chunk-66aa74b7":1,"chunk-66e337bf":1,"chunk-6db636c9":1,"chunk-77a4b6a4":1,"chunk-bef26562":1,"chunk-ca5cf8a6":1,"chunk-0956a750":1,"chunk-1f7abdbb":1};o[e]?t.push(o[e]):0!==o[e]&&s[e]&&t.push(o[e]=new Promise((function(t,s){for(var i="css/"+({}[e]||e)+"."+{"chunk-14956146":"6ba575ac","chunk-3a1e6ecc":"97004534","chunk-3b5de258":"f2910111","chunk-66aa74b7":"6ba575ac","chunk-66e337bf":"28e88315","chunk-6db636c9":"6ba575ac","chunk-77a4b6a4":"6ba575ac","chunk-bef26562":"6ba575ac","chunk-ca5cf8a6":"d2e2d61c","chunk-0956a750":"ac57fde6","chunk-1f7abdbb":"5574684e"}[e]+".css",n=l.p+i,a=document.getElementsByTagName("link"),r=0;r<a.length;r++){var c=a[r],u=c.getAttribute("data-href")||c.getAttribute("href");if("stylesheet"===c.rel&&(u===i||u===n))return t()}var d=document.getElementsByTagName("style");for(r=0;r<d.length;r++){c=d[r],u=c.getAttribute("data-href");if(u===i||u===n)return t()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=t,m.onerror=function(t){var i=t&&t.target&&t.target.src||n,a=new Error("Loading CSS chunk "+e+" failed.\n("+i+")");a.code="CSS_CHUNK_LOAD_FAILED",a.request=i,delete o[e],m.parentNode.removeChild(m),s(a)},m.href=n;var f=document.getElementsByTagName("head")[0];f.appendChild(m)})).then((function(){o[e]=0})));var i=n[e];if(0!==i)if(i)t.push(i[2]);else{var a=new Promise((function(t,s){i=n[e]=[t,s]}));t.push(i[2]=a);var c,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=r(e);var d=new Error;c=function(t){u.onerror=u.onload=null,clearTimeout(m);var s=n[e];if(0!==s){if(s){var i=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+i+": "+o+")",d.name="ChunkLoadError",d.type=i,d.request=o,s[1](d)}n[e]=void 0}};var m=setTimeout((function(){c({type:"timeout",target:u})}),12e4);u.onerror=u.onload=c,document.head.appendChild(u)}return Promise.all(t)},l.m=e,l.c=i,l.d=function(e,t,s){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},l.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(l.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)l.d(s,i,function(t){return e[t]}.bind(null,i));return s},l.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="/",l.oe=function(e){throw console.error(e),e};var c=window["webpackJsonp"]=window["webpackJsonp"]||[],u=c.push.bind(c);c.push=t,c=c.slice();for(var d=0;d<c.length;d++)t(c[d]);var m=u;a.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},"026b":function(e,t,s){},"058c":function(e,t,s){e.exports=s.p+"img/24.52e37bff.gif"},"09fe":function(e,t,s){"use strict";var i=s("6439"),o=s("91f8"),n=(s("ebcd"),s("2877")),a=Object(n["a"])(o["default"],i["a"],i["b"],!1,null,null,null);t["default"]=a.exports},"0abc":function(e,t,s){e.exports=s.p+"img/8.89742749.gif"},"1a05":function(e,t,s){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-upload",{attrs:{action:"#","http-request":e.onFileUpload,accept:null==e.fileTypes?"":e.fileTypes.join(","),"show-file-list":!1,disabled:e.disabled,"before-upload":e.beforeUpload,multiple:!0}},[e._t("default")],2)},o=[],n=(s("0643"),s("fffc"),{name:"fileUpload",data(){return{loading:null,uploadHeaders:{accessToken:sessionStorage.getItem("accessToken")}}},props:{action:{type:String,required:!1},fileTypes:{type:Array,default:null},maxSize:{type:Number,default:null},showLoading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},methods:{onFileUpload(e){this.showLoading&&(this.loading=this.$loading({lock:!0,text:"正在上传...",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"}));let t=new FormData;t.append("file",e.file),this.$http({url:this.action,data:t,method:"post",headers:{"Content-Type":"multipart/form-data"}}).then(t=>{this.$emit("success",t,e.file)}).catch(t=>{this.$emit("fail",t,e.file)}).finally(()=>{this.loading&&this.loading.close()})},beforeUpload(e){if(this.fileTypes&&this.fileTypes.length>0){let t=e.type,s=this.fileTypes.find(e=>e.toLowerCase()===t);if(void 0===s)return this.$message.error("文件格式错误，请上传以下格式的文件："+this.fileTypes.join("、")),!1}return this.maxSize&&e.size>this.maxSize?(this.$message.error(`文件大小不能超过 ${this.fileSizeStr}!`),!1):(this.$emit("before",e),!0)}},computed:{fileSizeStr(){return this.maxSize>1048576?Math.round(this.maxSize/1024/1024)+"M":this.maxSize>1024?Math.round(this.maxSize/1024)+"KB":this.maxSize+"B"}}}),a=n,r=s("2877"),l=Object(r["a"])(a,i,o,!1,null,null,null);t["a"]=l.exports},"1a8f":function(e,t,s){e.exports=s.p+"img/40.2b8929bd.gif"},2470:function(e,t,s){"use strict";s("e4d1")},"25a1":function(e,t){e.exports="data:image/gif;base64,R0lGODlhUABQAPcxANi7Mv/uRLmbKP/rPv/jRodoHf/xUf/mS/LSNf/wTv/dMKKCIv/sU//pSZd5I0UoEf/lNUwuE8KqNFY4FXdYG2BCFoBnJenTQGlKFz0gD+/aR/zfNbCZNP/1V6aLK+TJNtG7PXBSGf/pT+G7K+vGLf/vSv/yVerAKv/hMZJxHv/2Xf/gQ9exKf/ZMf/eOP/aM//oOfTdPP/nQf/iPv/VMP/IK/mxHv/PLP/SLf/PMP/3dP/LK/y7KfiqD+yIEvelDf2/LP/3bf/+4f/6p//92P/ELfWjCP/HMPisEfaiDP/AKv/LHO6NEferC/+3Df++J//DKf/LL/mzIf/KNvu5J/3BLv/HGviuGv/CFvqvEv/7tP/6mvmuD//JMv/7rv/xS/+8Ef/xXf/yc//ZOf/xbP+9Kv/jUP/xZf/dPv/eTf/2ZP/0UPGWDv/tZP/ZPvq2JPy0Gv/uWv/qX//VSPSeC/SZEP+4Iv/ye/23I/y0H//0iv63HvuyE/yoD//4e//9z//0mv/bSP+6Jv/VPP/LO//aQv/tdP/hbPCREf/RPv/bXP/aUv/eVf/mXv/iVv/VQvqwGfSmD+mDFPerF/OWEfaeD//AMP/sbf/ygv/fXP/dZP/QJP/ZTf/ogP/pcf/jXf/mbf/ukP/UT//OPf/4gv/sgv/OR/mhEPy9K//mev/FOP/YWf/iZP25Fv/RQ/68Gf/0kv/DNf/HPf/ldP/mZvCcAfzPLv/uif/qiP/vmf/pZ//WVP/5iv/6of/5kuqDE//8u/WmCP/RTPWoE/u2E//KIf/8xfaoDP/3xv/SN/7EMPKaCv/1vf/QNPvZNP/ypsumJ/OjBf/WNLaSI/PJLfOjC//TM+mCFINkHP/MNPOgBuqCFPKfBP/oVsOeJv/JQ+mCE+qCE//se+mBFP+uDvDgSv+yDf/PHwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/wtYTVAgRGF0YVhNUDw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NUVEMUIyMENFQjJEMTFFQzkzMDFFRTlDQ0MyNzBFMjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NUVEMUIyMERFQjJEMTFFQzkzMDFFRTlDQ0MyNzBFMjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RUQxQjIwQUVCMkQxMUVDOTMwMUVFOUNDQzI3MEUyNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RUQxQjIwQkVCMkQxMUVDOTMwMUVFOUNDQzI3MEUyNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PgH//v38+/r5+Pf29fTz8vHw7+7t7Ovq6ejn5uXk4+Lh4N/e3dzb2tnY19bV1NPS0dDPzs3My8rJyMfGxcTDwsHAv769vLu6ubi3trW0s7KxsK+urayrqqmop6alpKOioaCfnp2cm5qZmJeWlZSTkpGQj46NjIuKiYiHhoWEg4KBgH9+fXx7enl4d3Z1dHNycXBvbm1sa2ppaGdmZWRjYmFgX15dXFtaWVhXVlVUU1JRUE9OTUxLSklIR0ZFRENCQUA/Pj08Ozo5ODc2NTQz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"},"28f3":function(e,t,s){e.exports=s.p+"img/5.11e27819.gif"},"2dc8":function(e,t,s){"use strict";s("8240")},"32c6":function(e,t,s){e.exports=s.p+"img/19.89260df5.gif"},"34cb":function(e,t,s){e.exports=s.p+"img/2.302b51b8.gif"},"36a4":function(e,t,s){e.exports=s.p+"img/27.65ed7407.gif"},"37bf":function(e,t,s){e.exports=s.p+"img/47.b4ac667a.gif"},3854:function(e,t,s){e.exports=s.p+"img/25.6f582617.gif"},"3d2d":function(e,t,s){e.exports=s.p+"img/41.0b009f7b.gif"},"3dfc":function(e,t,s){e.exports=s.p+"img/4.be67348c.gif"},"3f29":function(e,t,s){e.exports=s.p+"img/9.0b2dd09a.gif"},4036:function(e,t,s){"use strict";var i=function(){var e,t=this,s=t._self._c;return s("div",{staticClass:"head-image",style:{cursor:t.isShowUserInfo?"pointer":null},on:{click:function(e){return t.showUserInfo(e)}}},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.url,expression:"url"}],staticClass:"avatar-image",style:t.avatarImageStyle,attrs:{src:t.url,loading:"lazy"}}),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.url,expression:"!url"}],staticClass:"avatar-text",style:t.avatarTextStyle},[t._v(" "+t._s(null===(e=t.name)||void 0===e?void 0:e.substring(0,2).toUpperCase())+" ")]),s("div",{directives:[{name:"show",rawName:"v-show",value:t.online,expression:"online"}],staticClass:"online",attrs:{title:"用户当前在线"}}),t._t("default")],2)},o=[],n={name:"headImage",data(){return{colors:["#5daa31","#c7515a","#e03697","#85029b","#c9b455","#326eb6"]}},props:{id:{type:Number},size:{type:Number,default:42},width:{type:Number},height:{type:Number},radius:{type:String,default:"50%"},url:{type:String},name:{type:String,default:null},online:{type:Boolean,default:!1},isShowUserInfo:{type:Boolean,default:!0}},methods:{showUserInfo(e){this.isShowUserInfo&&this.id&&this.id>0&&this.$http({url:"/user/find/"+this.id,method:"get"}).then(t=>{this.$store.commit("setUserInfoBoxPos",e),this.$store.commit("showUserInfoBox",t)})}},computed:{avatarImageStyle(){let e=this.width?this.width:this.size,t=this.height?this.height:this.size;return`width:${e}px; height:${t}px;\n\t\t\t\t\tborder-radius: ${this.radius};`},avatarTextStyle(){let e=this.width?this.width:this.size,t=this.height?this.height:this.size;return`\n\t\t\t\t  width: ${e}px;height:${t}px;\n\t\t\t\t\tbackground-color: ${this.name?this.textColor:"#fff"};\n\t\t\t\t\tfont-size:${.35*e}px;\n\t\t\t\t\tborder-radius: ${this.radius};\n\t\t\t\t\t`},textColor(){let e=0;for(var t=0;t<this.name.length;t++)e+=this.name.charCodeAt(t);return this.colors[e%this.colors.length]}}},a=n,r=(s("b9ad"),s("2877")),l=Object(r["a"])(a,i,o,!1,null,"68c2fa2e",null);t["a"]=l.exports},4518:function(e,t,s){e.exports=s.p+"img/12.c86081d0.gif"},"4d66":function(e,t,s){e.exports=s.p+"img/52.21a20728.gif"},"4fc8":function(e,t,s){e.exports=s.p+"img/22.1a731ef9.gif"},"50a5":function(e,t,s){e.exports=s.p+"img/16.942bf804.gif"},5234:function(e,t,s){},5347:function(e,t,s){e.exports=s.p+"img/39.a8484b5b.gif"},5541:function(e,t,s){e.exports=s.p+"img/30.5bd2ccd2.gif"},"56d7":function(e,t,s){"use strict";s.r(t);var i={};s.r(i),s.d(i,"connect",(function(){return Ie})),s.d(i,"reconnect",(function(){return Ae})),s.d(i,"close",(function(){return Ce})),s.d(i,"sendMessage",(function(){return Te})),s.d(i,"onConnect",(function(){return ye})),s.d(i,"onMessage",(function(){return Se})),s.d(i,"onClose",(function(){return xe}));var o={};s.r(o),s.d(o,"isNormal",(function(){return Me})),s.d(o,"isStatus",(function(){return ke})),s.d(o,"isTip",(function(){return we})),s.d(o,"isAction",(function(){return Pe})),s.d(o,"isRtcPrivate",(function(){return Ne})),s.d(o,"isRtcGroup",(function(){return Fe}));var n={};s.r(n),s.d(n,"MESSAGE_TYPE",(function(){return Qe})),s.d(n,"RTC_STATE",(function(){return Ye})),s.d(n,"TERMINAL_TYPE",(function(){return ze})),s.d(n,"MESSAGE_STATUS",(function(){return Je}));var a={};s.r(a),s.d(a,"toTimeText",(function(){return ot})),s.d(a,"isYestday",(function(){return nt})),s.d(a,"isYear",(function(){return at})),s.d(a,"formatDateTime",(function(){return rt}));var r=s("2b0e"),l=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},c=[],u={name:"App",components:{}},d=u,m=(s("97db"),s("2877")),f=Object(m["a"])(d,l,c,!1,null,null,null),p=f.exports,h=s("8c4f"),g=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-view"},[t("div",{staticClass:"login-content"},[t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"status-icon":"",rules:e.rules,"label-width":"60px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitForm("loginForm")}}},[t("div",{staticClass:"login-brand"},[t("img",{staticClass:"logo",attrs:{src:s("5b62")}}),t("div",[e._v("登录飞克尔")])]),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],attrs:{label:"终端",prop:"userName"}},[t("el-input",{attrs:{type:"terminal",autocomplete:"off"},model:{value:e.loginForm.terminal,callback:function(t){e.$set(e.loginForm,"terminal",t)},expression:"loginForm.terminal"}})],1),t("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[t("el-input",{attrs:{type:"userName",autocomplete:"off",placeholder:"用户名"},model:{value:e.loginForm.userName,callback:function(t){e.$set(e.loginForm,"userName",t)},expression:"loginForm.userName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"密码"},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("loginForm")}}},[e._v("登录")]),t("el-button",{on:{click:function(t){return e.resetForm("loginForm")}}},[e._v("清空")])],1),t("div",{staticClass:"register"},[t("router-link",{attrs:{to:"/register"}},[e._v("没有账号,前往注册")])],1)],1)],1),t("icp")],1)},b=[],v=(s("d9e2"),s("14d9"),s("09fe")),I={name:"login",components:{Icp:v["default"]},data(){var e=(e,t,s)=>{if(!t)return s(new Error("请输入用户名"));s()},t=(e,t,s)=>{""===t&&s(new Error("请输入密码")),s()};return{loginForm:{terminal:this.$enums.TERMINAL_TYPE.WEB,userName:"",password:""},rules:{userName:[{validator:e,trigger:"blur"}],password:[{validator:t,trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate(e=>{e&&this.$http({url:"/login",method:"post",data:this.loginForm}).then(e=>{this.setCookie("username",this.loginForm.userName),this.setCookie("password",this.loginForm.password),sessionStorage.setItem("accessToken",e.accessToken),sessionStorage.setItem("refreshToken",e.refreshToken),this.$message.success("登录成功"),this.$router.push("/home/chat")})})},resetForm(e){this.$refs[e].resetFields()},getCookie(e){let t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),s=document.cookie.match(t);return s?unescape(s[2]):""},setCookie(e,t){document.cookie=e+"="+escape(t)}},mounted(){this.loginForm.userName=this.getCookie("username"),this.loginForm.password=this.getCookie("password")}},A=I,C=(s("b2d8"),Object(m["a"])(A,g,b,!1,null,"160560ee",null)),E=C.exports,T=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"register-view"},[t("div",[t("el-form",{ref:"registerForm",staticClass:"web-ruleForm",attrs:{model:e.registerForm,"status-icon":"",rules:e.rules,"label-width":"80px"}},[t("div",{staticClass:"register-brand"},[t("img",{staticClass:"logo",attrs:{src:s("5b62")}}),t("div",[e._v("欢迎成为飞克尔的用户")])]),t("el-form-item",{attrs:{label:"用户名",prop:"userName"}},[t("el-input",{attrs:{type:"userName",autocomplete:"off",placeholder:"用户名(登录使用)"},model:{value:e.registerForm.userName,callback:function(t){e.$set(e.registerForm,"userName",t)},expression:"registerForm.userName"}})],1),t("el-form-item",{attrs:{label:"昵称",prop:"nickName"}},[t("el-input",{attrs:{type:"nickName",autocomplete:"off",placeholder:"昵称"},model:{value:e.registerForm.nickName,callback:function(t){e.$set(e.registerForm,"nickName",t)},expression:"registerForm.nickName"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"密码"},model:{value:e.registerForm.password,callback:function(t){e.$set(e.registerForm,"password",t)},expression:"registerForm.password"}})],1),t("el-form-item",{attrs:{label:"确认密码",prop:"confirmPassword"}},[t("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"确认密码"},model:{value:e.registerForm.confirmPassword,callback:function(t){e.$set(e.registerForm,"confirmPassword",t)},expression:"registerForm.confirmPassword"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("registerForm")}}},[e._v("注册")]),t("el-button",{on:{click:function(t){return e.resetForm("registerForm")}}},[e._v("清空")])],1),t("div",{staticClass:"to-login"},[t("router-link",{attrs:{to:"/login"}},[e._v("已有账号,前往登录")])],1)],1)],1),t("icp")],1)},y=[],S={name:"login",components:{Icp:v["default"]},data(){var e=(e,t,s)=>{if(!t)return s(new Error("请输入用户名"));s()},t=(e,t,s)=>{if(!t)return s(new Error("请输入昵称"));s()},s=(e,t,s)=>{if(""===t)return s(new Error("请输入密码"));s()},i=(e,t,s)=>""===t?s(new Error("请输入密码")):t!=this.registerForm.password?s(new Error("两次密码输入不一致")):void s();return{registerForm:{userName:"",nickName:"",password:"",confirmPassword:""},rules:{userName:[{validator:e,trigger:"blur"}],nickName:[{validator:t,trigger:"blur"}],password:[{validator:s,trigger:"blur"}],confirmPassword:[{validator:i,trigger:"blur"}]}}},methods:{submitForm(e){this.$refs[e].validate(e=>{e&&this.$http({url:"/register",method:"post",data:this.registerForm}).then(e=>{this.$message.success("注册成功!")})})},resetForm(e){this.$refs[e].resetFields()}}},x=S,M=(s("71a0"),Object(m["a"])(x,T,y,!1,null,"4f5756ce",null)),k=M.exports,w=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home-page"},[t("div",{staticClass:"app-container",class:{fullscreen:e.isFullscreen}},[t("div",{staticClass:"navi-bar"},[t("div",{staticClass:"navi-bar-box"},[t("div",{staticClass:"top"},[t("div",{staticClass:"user-head-image"},[t("head-image",{attrs:{name:e.$store.state.userStore.userInfo.nickName,size:38,url:e.$store.state.userStore.userInfo.headImageThumb},nativeOn:{click:function(t){e.showSettingDialog=!0}}})],1),t("div",{staticClass:"menu"},[t("router-link",{staticClass:"link",attrs:{to:"/home/chat"}},[t("div",{staticClass:"menu-item"},[t("span",{staticClass:"icon iconfont icon-chat"}),t("div",{directives:[{name:"show",rawName:"v-show",value:e.unreadCount>0,expression:"unreadCount > 0"}],staticClass:"unread-text"},[e._v(e._s(e.unreadCount))])])]),t("router-link",{staticClass:"link",attrs:{to:"/home/friend"}},[t("div",{staticClass:"menu-item"},[t("span",{staticClass:"icon iconfont icon-friend"})])]),t("router-link",{staticClass:"link",attrs:{to:"/home/group"}},[t("div",{staticClass:"menu-item"},[t("span",{staticClass:"icon iconfont icon-group",staticStyle:{"font-size":"28px"}})])])],1)]),t("div",{staticClass:"botoom"},[0===e.$store.state.userStore.userInfo.type?t("div",{staticClass:"botoom-item",on:{click:e.goToAdmin}},[t("i",{staticClass:"icon iconfont icon-minganciciku"})]):e._e(),t("div",{staticClass:"botoom-item",on:{click:function(t){e.isFullscreen=!e.isFullscreen}}},[t("i",{staticClass:"el-icon-full-screen"})]),t("div",{staticClass:"botoom-item",on:{click:e.showSetting}},[t("span",{staticClass:"icon iconfont icon-setting",staticStyle:{"font-size":"20px"}})]),t("div",{staticClass:"botoom-item",attrs:{title:"退出"},on:{click:function(t){return e.onExit()}}},[t("span",{staticClass:"icon iconfont icon-exit"})])])])]),t("div",{staticClass:"content-box"},[t("router-view")],1),t("setting",{attrs:{visible:e.showSettingDialog},on:{close:function(t){return e.closeSetting()}}}),t("user-info",{directives:[{name:"show",rawName:"v-show",value:e.uiStore.userInfo.show,expression:"uiStore.userInfo.show"}],attrs:{pos:e.uiStore.userInfo.pos,user:e.uiStore.userInfo.user},on:{close:function(t){return e.$store.commit("closeUserInfoBox")}}}),t("full-image",{attrs:{visible:e.uiStore.fullImage.show,url:e.uiStore.fullImage.url},on:{close:function(t){return e.$store.commit("closeFullImageBox")}}})],1)])},P=[],N=(s("0643"),s("4e3e"),s("4036")),F=function(){var e=this,t=e._self._c;return t("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],staticClass:"setting",attrs:{title:"设置",visible:e.visible,width:"420px","before-close":e.onClose},on:{"update:visible":function(t){e.visible=t}}},[t("el-form",{ref:"settingForm",attrs:{model:e.userInfo,"label-width":"80px",rules:e.rules,size:"small"}},[t("el-form-item",{staticStyle:{"margin-bottom":"0 !important"},attrs:{label:"头像"}},[t("file-upload",{staticClass:"avatar-uploader",attrs:{action:e.imageAction,showLoading:!0,maxSize:e.maxSize,fileTypes:["image/jpeg","image/png","image/jpg","image/webp"]},on:{success:e.onUploadSuccess}},[e.userInfo.headImage?t("img",{staticClass:"avatar",attrs:{src:e.userInfo.headImage}}):t("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),t("el-form-item",{attrs:{label:"用户名"}},[t("el-input",{attrs:{disabled:"",autocomplete:"off",size:"small"},model:{value:e.userInfo.userName,callback:function(t){e.$set(e.userInfo,"userName",t)},expression:"userInfo.userName"}})],1),t("el-form-item",{attrs:{prop:"nickName",label:"昵称"}},[t("el-input",{attrs:{autocomplete:"off",size:"small"},model:{value:e.userInfo.nickName,callback:function(t){e.$set(e.userInfo,"nickName",t)},expression:"userInfo.nickName"}})],1),t("el-form-item",{attrs:{label:"性别"}},[t("el-radio-group",{model:{value:e.userInfo.sex,callback:function(t){e.$set(e.userInfo,"sex",t)},expression:"userInfo.sex"}},[t("el-radio",{attrs:{label:0}},[e._v("男")]),t("el-radio",{attrs:{label:1}},[e._v("女")])],1)],1),t("el-form-item",{attrs:{label:"个性签名"}},[t("el-input",{attrs:{type:"textarea",rows:3,maxlength:"64"},model:{value:e.userInfo.signature,callback:function(t){e.$set(e.userInfo,"signature",t)},expression:"userInfo.signature"}})],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:function(t){return e.onClose()}}},[e._v("取 消")]),t("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit()}}},[e._v("确 定")])],1)],1)},G=[],O=s("1a05"),R={name:"setting",components:{FileUpload:O["a"]},data(){return{userInfo:{},maxSize:5242880,action:"/image/upload",rules:{nickName:[{required:!0,message:"请输入昵称",trigger:"blur"}]}}},methods:{onClose(){this.$emit("close")},onSubmit(){this.$refs["settingForm"].validate(e=>{if(!e)return!1;this.$http({url:"/user/update",method:"put",data:this.userInfo}).then(()=>{this.$store.commit("setUserInfo",this.userInfo),this.$emit("close"),this.$message.success("修改成功")})})},onUploadSuccess(e,t){this.userInfo.headImage=e.originUrl,this.userInfo.headImageThumb=e.thumbUrl}},props:{visible:{type:Boolean}},computed:{imageAction(){return"/image/upload"}},watch:{visible:function(e,t){let s=this.$store.state.userStore.userInfo;this.userInfo=JSON.parse(JSON.stringify(s))}}},D=R,$=(s("adec"),Object(m["a"])(D,F,G,!1,null,null,null)),L=$.exports,_=function(){var e=this,t=e._self._c;return t("div",{staticClass:"user-info-mask",on:{click:function(t){return e.$emit("close")}}},[t("div",{staticClass:"user-info",style:{left:e.pos.x+"px",top:e.pos.y+"px"},on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"user-info-box"},[t("div",{staticClass:"avatar"},[t("head-image",{attrs:{name:e.user.nickName,url:e.user.headImageThumb,size:70,online:e.user.online,radius:"10%"},nativeOn:{click:function(t){return e.showFullImage()}}})],1),t("div",[t("el-descriptions",{staticClass:"user-info-items",attrs:{column:1,title:e.user.nickName}},[t("el-descriptions-item",{attrs:{label:"用户名"}},[e._v(e._s(e.user.userName)+" ")]),t("el-descriptions-item",{attrs:{label:"签名"}},[e._v(e._s(e.user.signature)+" ")])],1)],1)]),t("el-divider",{attrs:{"content-position":"center"}}),t("div",{staticClass:"user-btn-group"},[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.isFriend,expression:"isFriend"}],attrs:{type:"primary"},on:{click:function(t){return e.onSendMessage()}}},[e._v("发消息")]),t("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.isFriend,expression:"!isFriend"}],attrs:{type:"primary"},on:{click:function(t){return e.onAddFriend()}}},[e._v("加为好友")])],1)],1)])},U=[],H={name:"userInfo",components:{HeadImage:N["a"]},data(){return{}},props:{user:{type:Object},pos:{type:Object}},methods:{onSendMessage(){let e=this.user,t={type:"PRIVATE",targetId:e.id,showName:e.nickName,headImage:e.headImage};this.$store.commit("openChat",t),this.$store.commit("activeChat",0),"/home/chat"!=this.$route.path&&this.$router.push("/home/chat"),this.$emit("close")},onAddFriend(){this.$http({url:"/friend/add",method:"post",params:{friendId:this.user.id}}).then(()=>{this.$message.success("添加成功，对方已成为您的好友");let e={id:this.user.id,nickName:this.user.nickName,headImage:this.user.headImageThumb,online:this.user.online,deleted:!1};this.$store.commit("addFriend",e)})},showFullImage(){this.user.headImage&&this.$store.commit("showFullImageBox",this.user.headImage)}},computed:{isFriend(){return this.$store.getters.isFriend(this.user.id)}}},j=H,B=(s("8786"),Object(m["a"])(j,_,U,!1,null,null,null)),W=B.exports,Q=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"show",rawName:"v-show",value:e.visible,expression:"visible"}],staticClass:"full-image",attrs:{"before-close":e.onClose,modal:!0}},[t("div",{staticClass:"mask"}),t("div",{staticClass:"image-box"},[t("img",{attrs:{src:e.url}})]),t("div",{staticClass:"close",on:{click:e.onClose}},[t("i",{staticClass:"el-icon-close"})])])},Y=[],z={name:"fullImage",data(){return{fit:"contain"}},methods:{onClose(){this.$emit("close")}},props:{visible:{type:Boolean},url:{type:String}}},J=z,Z=(s("2470"),Object(m["a"])(J,Q,Y,!1,null,null,null)),V=Z.exports,K={components:{HeadImage:N["a"],Setting:L,UserInfo:W,FullImage:V},data(){return{showSettingDialog:!1,lastPlayAudioTime:(new Date).getTime()-1e3,isFullscreen:!0,reconnecting:!1}},methods:{init(){this.$store.dispatch("load").then(()=>{this.$wsApi.connect("ws://localhost:8878/chat",sessionStorage.getItem("accessToken")),this.$wsApi.onConnect(()=>{this.reconnecting?this.onReconnectWs():(this.pullPrivateOfflineMessage(this.$store.state.chatStore.privateMsgMaxId),this.pullGroupOfflineMessage(this.$store.state.chatStore.groupMsgMaxId))}),this.$wsApi.onMessage((e,t)=>{2==e?(this.$wsApi.close(3e3),this.$alert("您已在其他地方登录，将被强制下线","强制下线通知",{confirmButtonText:"确定",callback:e=>{location.href="/"}})):3==e?this.handlePrivateMessage(t):4==e?this.handleGroupMessage(t):5==e&&this.handleSystemMessage(t)}),this.$wsApi.onClose(e=>{console.log(e),3e3!=e.code&&this.reconnectWs()})}).catch(e=>{console.log("初始化失败",e)})},reconnectWs(){this.reconnecting=!0,this.$store.dispatch("loadUser").then(()=>{this.$message.error("连接断开，正在尝试重新连接..."),this.$wsApi.reconnect("ws://localhost:8878/chat",sessionStorage.getItem("accessToken"))}).catch(()=>{setTimeout(()=>this.reconnectWs(),1e4)})},onReconnectWs(){this.reconnecting=!1;const e=[];e.push(this.$store.dispatch("loadFriend")),e.push(this.$store.dispatch("loadGroup")),Promise.all(e).then(()=>{this.pullPrivateOfflineMessage(this.$store.state.chatStore.privateMsgMaxId),this.pullGroupOfflineMessage(this.$store.state.chatStore.groupMsgMaxId),this.$message.success("重新连接成功")}).catch(()=>{this.$message.error("初始化失败"),this.onExit()})},pullPrivateOfflineMessage(e){this.$store.commit("loadingPrivateMsg",!0),this.$http({url:"/message/private/pullOfflineMessage?minId="+e,method:"GET"}).catch(()=>{this.$store.commit("loadingPrivateMsg",!1)})},pullGroupOfflineMessage(e){this.$store.commit("loadingGroupMsg",!0),this.$http({url:"/message/group/pullOfflineMessage?minId="+e,method:"GET"}).catch(()=>{this.$store.commit("loadingGroupMsg",!1)})},handlePrivateMessage(e){e.selfSend=e.sendId==this.$store.state.userStore.userInfo.id;let t=e.selfSend?e.recvId:e.sendId,s={type:"PRIVATE",targetId:t};if(e.type!=this.$enums.MESSAGE_TYPE.LOADING)if(e.type!=this.$enums.MESSAGE_TYPE.READED)if(e.type!=this.$enums.MESSAGE_TYPE.RECEIPT)if(e.type!=this.$enums.MESSAGE_TYPE.RECALL&&e.type!=this.$enums.MESSAGE_TYPE.ADMINRC)if(e.type!=this.$enums.MESSAGE_TYPE.FRIEND_NEW)if(e.type!=this.$enums.MESSAGE_TYPE.FRIEND_DEL){if(this.$msgType.isNormal(e.type)||this.$msgType.isTip(e.type)||this.$msgType.isAction(e.type)){let s=this.loadFriendInfo(t);this.insertPrivateMessage(s,e)}}else this.$store.commit("removeFriend",t);else this.$store.commit("addFriend",JSON.parse(e.content));else this.$store.commit("recallMessage",[e,s]);else this.$store.commit("readedMessage",{friendId:e.sendId});else this.$store.commit("resetUnreadCount",s);else this.$store.commit("loadingPrivateMsg",JSON.parse(e.content))},insertPrivateMessage(e,t){let s={type:"PRIVATE",targetId:e.id,showName:e.nickName,headImage:e.headImage};this.$store.commit("openChat",s),this.$store.commit("insertMessage",[t,s]),!t.selfSend&&this.$msgType.isNormal(t.type)&&t.status!=this.$enums.MESSAGE_STATUS.READED&&this.playAudioTip()},handleGroupMessage(e){e.selfSend=e.sendId==this.$store.state.userStore.userInfo.id;let t={type:"GROUP",targetId:e.groupId};if(e.type!=this.$enums.MESSAGE_TYPE.LOADING)if(e.type!=this.$enums.MESSAGE_TYPE.READED)if(e.type!=this.$enums.MESSAGE_TYPE.RECEIPT)if(e.type!=this.$enums.MESSAGE_TYPE.RECALL)if(e.type!=this.$enums.MESSAGE_TYPE.GROUP_NEW){if(e.type==this.$enums.MESSAGE_TYPE.GROUP_DEL)return console.log("this.$enums.MESSAGE_TYPE.GROUP_DE"),void this.$store.commit("removeGroup",e.groupId);if(this.$msgType.isNormal(e.type)||this.$msgType.isTip(e.type)||this.$msgType.isAction(e.type)){let t=this.loadGroupInfo(e.groupId);this.insertGroupMessage(t,e)}}else this.$store.commit("addGroup",JSON.parse(e.content));else this.$store.commit("recallMessage",[e,t]);else{let s={id:e.id,groupId:e.groupId,readedCount:e.readedCount,receiptOk:e.receiptOk};this.$store.commit("updateMessage",[s,t])}else this.$store.commit("resetUnreadCount",t);else this.$store.commit("loadingGroupMsg",JSON.parse(e.content))},insertGroupMessage(e,t){let s={type:"GROUP",targetId:e.id,showName:e.showGroupName,headImage:e.headImageThumb};this.$store.commit("openChat",s),this.$store.commit("insertMessage",[t,s]),!t.selfSend&&t.type<=this.$enums.MESSAGE_TYPE.VIDEO&&t.status!=this.$enums.MESSAGE_STATUS.READED&&this.playAudioTip()},handleSystemMessage(e){if(e.type==this.$enums.MESSAGE_TYPE.USER_BANNED)return this.$wsApi.close(3e3),void this.$alert("您的账号已被管理员封禁,原因:"+e.content,"账号被封禁",{confirmButtonText:"确定",callback:e=>{this.onExit()}})},onExit(){this.$wsApi.close(3e3),sessionStorage.removeItem("accessToken"),location.href="/"},goToAdmin(){this.$wsApi.close(3e3),this.$router.push("/adminHome")},playAudioTip(){if(!this.$store.getters.isLoading()&&(new Date).getTime()-this.lastPlayAudioTime>1e3){this.lastPlayAudioTime=(new Date).getTime();let e=new Audio,t=s("f2b0");e.src=t,e.play()}},showSetting(){this.showSettingDialog=!0},closeSetting(){this.showSettingDialog=!1},loadFriendInfo(e){let t=this.$store.getters.findFriend(e);return t||(t={id:e,showNickName:"未知用户",headImage:""}),t},loadGroupInfo(e){let t=this.$store.getters.findGroup(e);return t||(t={id:e,showGroupName:"未知群聊",headImageThumb:""}),t}},computed:{uiStore(){return this.$store.state.uiStore},unreadCount(){let e=0,t=this.$store.state.chatStore.chats;return t.forEach(t=>{t.delete||(e+=t.unreadCount)}),e}},watch:{unreadCount:{handler(e,t){let s=e>0?e+"条未读":"";this.$elm.setTitleTip(s)},immediate:!0}},mounted(){this.init()},unmounted(){this.$wsApi.close()}},q=K,X=(s("2dc8"),Object(m["a"])(q,w,P,!1,null,"6e808c3c",null)),ee=X.exports,te=function(){var e=this,t=e._self._c;return t("div",{staticClass:"home-page"},[t("div",{staticClass:"app-container"},[t("div",{staticClass:"title"},[t("div",{staticClass:"t-left"},[t("div",{staticClass:"menuIcon"},[t("div",{class:e.isMenuOpen?"opened":"closed"},[t("span",{staticClass:"icon iconfont icon-shouqicaidan",on:{click:e.toggleMenu}}),t("span",{staticClass:"icon iconfont icon-caidan",on:{click:e.toggleMenu}})])]),t("router-link",{attrs:{to:"/adminHome"}},[t("div",{staticClass:"logo"})]),t("span",[e._v("飞克尔后台管理系统")])],1),t("div",{staticClass:"t-right"},[t("HeadImage",{attrs:{name:e.$store.state.userStore.userInfo.nickName,size:38,url:e.$store.state.userStore.userInfo.headImageThumb}}),t("span",[e._v(e._s(e.$store.state.userStore.userInfo.nickName))]),t("span",{staticClass:"icon iconfont icon-exit",on:{click:e.logout}})],1)]),t("div",{staticClass:"homeMain"},[t("div",{class:["menu",e.isMenuOpen?"":"closed"]},[t("ul",{staticClass:"item1"},[t("router-link",{attrs:{to:"/adminHome"}},[t("li",{class:{selected:e.isSelected("/adminHome")}},[t("span",{staticClass:"icon iconfont icon-ai-home"},[e._v("首页")])])]),e._l(e.menuItems,(function(s,i){return t("li",{key:i,attrs:{"data-index":i}},[t("span",{class:["icon","iconfont",s.icon],on:{click:function(t){return e.showItem(i)}}},[e._v(e._s(s.label))]),t("i",{staticClass:"icon iconfont icon-shangjiantou",class:{opened:e.isOpen(i)}}),t("ul",{staticClass:"item2",class:{show:e.isOpen(i)}},e._l(s.children,(function(s){return t("router-link",{key:s.path,attrs:{to:s.path}},[t("li",{class:{selected:e.isSelected(s.path)}},[e._v(e._s(s.label)+" ")])])})),1)])})),t("router-link",{attrs:{to:"/adminHome/adminSetting"}},[t("li",{class:{selected:e.isSelected("/adminHome/adminSetting")}},[t("span",{staticClass:"icon iconfont icon-setting"},[e._v("设置")])])])],2)]),t("div",{staticClass:"view-box"},[t("router-view")],1)])])])},se=[],ie=(s("9a9a"),{components:{HeadImage:N["a"],RouterLink:h["a"]},data(){return{openMenuIndex:null,isMenuOpen:!0,menuItems:[{icon:"icon-friend",label:"用户管理",children:[{path:"/adminHome/userList",label:"用户列表"},{path:"/adminHome/bannedUserList",label:"封禁用户列表"}]},{icon:"icon-group",label:"群聊管理",children:[{path:"/adminHome/groupList",label:"群聊列表"},{path:"/adminHome/bannedGroupList",label:"封禁群聊列表"}]},{icon:"icon-minganciciku",label:"敏感词管理",children:[{path:"/adminHome/sensitiveWordList",label:"敏感词列表"},{path:"/adminHome/privateSensitiveWordHit",label:"私聊敏感词命中"},{path:"/adminHome/groupSensitiveWordHit",label:"群聊敏感词命中"}]},{icon:"icon-chat",label:"消息管理",children:[{path:"/adminHome/privateMessageList",label:"私聊消息列表"},{path:"/adminHome/groupMessageList",label:"群聊消息列表"},{path:"/adminHome/broadcastMessage",label:"广播消息"}]}]}},methods:{init(){void 0===this.$store.state.userStore.userInfo.userName&&(sessionStorage.removeItem("assessToken"),location.href="/"),this.openMenuIndex=this.menuItems.findIndex(e=>e.children.some(e=>e.path===this.currentRoute))},showItem(e){this.openMenuIndex=this.openMenuIndex===e?null:e},logout(){this.$router.push("/home/chat")},toggleMenu(){this.isMenuOpen=!this.isMenuOpen}},computed:{isOpen(){return e=>this.openMenuIndex===e},isSelected(){return e=>this.currentRoute===e},currentRoute(){return this.$route.path}},mounted(){this.init()}}),oe=ie,ne=(s("eada"),Object(m["a"])(oe,te,se,!1,null,"7ca25138",null)),ae=ne.exports;r["default"].use(h["b"]);var re=new h["b"]({routes:[{path:"/",redirect:"/login"},{name:"Login",path:"/login",component:E},{name:"Register",path:"/register",component:k},{name:"Home",path:"/home",component:ee,children:[{name:"Chat",path:"/home/chat",component:()=>s.e("chunk-3b5de258").then(s.bind(null,"3f94"))},{name:"Friend",path:"/home/friend",component:()=>Promise.all([s.e("chunk-ca5cf8a6"),s.e("chunk-0956a750")]).then(s.bind(null,"63b9"))},{name:"GROUP",path:"/home/group",component:()=>Promise.all([s.e("chunk-ca5cf8a6"),s.e("chunk-1f7abdbb")]).then(s.bind(null,"5c36"))}]},{path:"/adminHome",component:ae,children:[{name:"adminHome",path:"",component:()=>s.e("chunk-3a1e6ecc").then(s.bind(null,"8580"))},{name:"userList",path:"/adminHome/userList",component:()=>s.e("chunk-14956146").then(s.bind(null,"3ec5")),props:{banned:!1}},{name:"bannedUserList",path:"/adminHome/bannedUserList",component:()=>s.e("chunk-14956146").then(s.bind(null,"3ec5")),props:{banned:!0}},{name:"groupList",path:"/adminHome/groupList",component:()=>s.e("chunk-6db636c9").then(s.bind(null,"b3f6")),props:{banned:!1}},{name:"bannedGroupList",path:"/adminHome/bannedGroupList",component:()=>s.e("chunk-6db636c9").then(s.bind(null,"b3f6")),props:{banned:!0}},{name:"sensitiveWordList",path:"/adminHome/sensitiveWordList",component:()=>s.e("chunk-66aa74b7").then(s.bind(null,"440c"))},{name:"privateSensitiveWordHit",path:"/adminHome/privateSensitiveWordHit",component:()=>s.e("chunk-bef26562").then(s.bind(null,"d3f2")),props:{messageType:"private"}},{name:"groupSensitiveWordHit",path:"/adminHome/groupSensitiveWordHit",component:()=>s.e("chunk-bef26562").then(s.bind(null,"d3f2")),props:{messageType:"group"}},{name:"privateMessageList",path:"/adminHome/privateMessageList",component:()=>s.e("chunk-77a4b6a4").then(s.bind(null,"9962")),props:{messageType:"private"}},{name:"groupMessageList",path:"/adminHome/groupMessageList",component:()=>s.e("chunk-77a4b6a4").then(s.bind(null,"9962")),props:{messageType:"group"}},{name:"adminSetting",path:"/adminHome/adminSetting",component:()=>s.e("chunk-66e337bf").then(s.bind(null,"a509"))}]}]}),le=s("5c96"),ce=s.n(le),ue=(s("6178"),s("be35"),s("cee4"));const de=ue["a"].create({baseURL:"",timeout:3e4,withCredentials:!0});de.interceptors.request.use(e=>{let t=sessionStorage.getItem("accessToken");return t&&(e.headers.accessToken=encodeURIComponent(t)),e},e=>Promise.reject(e)),de.interceptors.response.use(async e=>{if(200==e.data.code)return e.data.data;if(400!=e.data.code){if(401==e.data.code){console.log("token失效，尝试重新获取");let t=sessionStorage.getItem("refreshToken");t||(location.href="/");const s=await de({method:"put",url:"/refreshToken",headers:{refreshToken:t}}).catch(()=>{location.href="/"});return sessionStorage.setItem("accessToken",s.accessToken),sessionStorage.setItem("refreshToken",s.refreshToken),de(e.config)}return Object(le["Message"])({message:e.data.message,type:"error",duration:1500,customClass:"element-error-message-zindex"}),Promise.reject(e.data)}location.href="/"},e=>{switch(e.response.status){case 400:Object(le["Message"])({message:e.response.data,type:"error",duration:1500,customClass:"element-error-message-zindex"});break;case 401:location.href="/";break;case 405:Object(le["Message"])({message:"http请求方式有误",type:"error",duration:1500,customClass:"element-error-message-zindex"});break;case 404:case 500:Object(le["Message"])({message:"服务器出了点小差，请稍后再试",type:"error",duration:1500,customClass:"element-error-message-zindex"});break;case 501:Object(le["Message"])({message:"服务器不支持当前请求所需要的某个功能",type:"error",duration:1500,customClass:"element-error-message-zindex"});break}return Promise.reject(e)});var me=de,fe=null;let pe,he=!1,ge=null,be=null,ve=null,Ie=(e,t)=>{try{if(he)return;console.log("连接WebSocket"),fe=new WebSocket(e),fe.onmessage=function(e){let t=JSON.parse(e.data);0==t.cmd?(Ee.start(),ge&&ge(),console.log("WebSocket登录成功")):1==t.cmd?Ee.reset():(console.log("收到消息:",t),be&&be(t.cmd,t.data))},fe.onclose=function(e){console.log("WebSocket连接关闭"),he=!1,ve&&ve(e)},fe.onopen=function(){console.log("WebSocket连接成功"),he=!0;let e={cmd:0,data:{accessToken:t}};fe.send(JSON.stringify(e))},fe.onerror=function(){console.log("WebSocket连接发生错误"),he=!1,Ae(e,t)}}catch(s){console.log("尝试创建连接失败"),Ae(e,t)}},Ae=(e,t)=>{console.log("尝试重新连接"),he||(pe&&clearTimeout(pe),pe=setTimeout((function(){Ie(e,t)}),15e3))},Ce=e=>{fe&&fe.close(e)},Ee={timeout:5e3,timeoutObj:null,start:function(){if(he){console.log("发送WebSocket心跳");let e={cmd:1,data:{}};fe.send(JSON.stringify(e))}},reset:function(){clearTimeout(this.timeoutObj),this.timeoutObj=setTimeout((function(){Ee.start()}),this.timeout)}},Te=e=>{fe.readyState===fe.OPEN?fe.send(JSON.stringify(e)):(fe.readyState,fe.CONNECTING,setTimeout((function(){Te(e)}),1e3))},ye=e=>{ge=e},Se=e=>{be=e},xe=e=>{ve=e},Me=function(e){return e>=0&&e<10},ke=function(e){return e>=10&&e<20},we=function(e){return e>=20&&e<30},Pe=function(e){return e>=40&&e<50},Ne=function(e){return e>=100&&e<200},Fe=function(e){return e>=200&&e<300};const Ge=["憨笑","媚眼","开心","坏笑","可怜","爱心","笑哭","拍手","惊喜","打气","大哭","流泪","饥饿","难受","健身","示爱","色色","眨眼","暴怒","惊恐","思考","头晕","大吐","酷笑","翻滚","享受","鼻涕","快乐","雀跃","微笑","贪婪","红心","粉心","星星","大火","眼睛","音符","叹号","问号","绿叶","燃烧","喇叭","警告","信封","房子","礼物","点赞","举手","拍手","点头","摇头","偷瞄","庆祝","疾跑","打滚","惊吓","起跳"];let Oe=(e,t)=>e.replace(/\#[\u4E00-\u9FA5]{1,3}\;/gi,e=>Re(e,t)),Re=(e,t)=>{let i=e.replace(/\#|\;/gi,""),o=Ge.indexOf(i);if(-1==o)return e;let n=s("642d")(`./${o}.gif`);return`<img src="${n}" class="${t}" />`},De=e=>{let t=e.replace(/\#|\;/gi,""),i=Ge.indexOf(t);if(-1==i)return"";let o=s("642d")(`./${i}.gif`);return o};var $e={emoTextList:Ge,transform:Oe,textToImg:Re,textToUrl:De};let Le=(e,t)=>{const s=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]|\bwww\.[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi;return e.replace(s,e=>(e.startsWith("http")||(e="http://"+e),`<a href="${e}" target="_blank" style="color: ${t};text-decoration: underline;">${e}</a>`))};var _e={replaceURLWithHTMLLinks:Le};let Ue=e=>{var t=e.offsetTop;return null!=e.offsetParent&&(t+=Ue(e.offsetParent)),t},He=e=>{var t=e.offsetLeft;return null!=e.offsetParent&&(t+=He(e.offsetParent)),t},je=e=>{let t="FICQ";e&&(t=`(${e})${t}`),document.title=t};var Be={fixTop:Ue,fixLeft:He,setTitleTip:je},We=s("2f62");s("2382"),s("fffc");const Qe={TEXT:0,IMAGE:1,FILE:2,AUDIO:3,VIDEO:4,SENTEXT:5,RECALL:10,READED:11,RECEIPT:12,ADMINRC:13,TIP_TIME:20,TIP_TEXT:21,LOADING:30,ACT_RT_VOICE:40,ACT_RT_VIDEO:41,USER_BANNED:50,FRIEND_NEW:80,FRIEND_DEL:81,GROUP_NEW:90,GROUP_DEL:91,RTC_CALL_VOICE:100,RTC_CALL_VIDEO:101,RTC_ACCEPT:102,RTC_REJECT:103,RTC_CANCEL:104,RTC_FAILED:105,RTC_HANDUP:106,RTC_CANDIDATE:107,RTC_GROUP_SETUP:200,RTC_GROUP_ACCEPT:201,RTC_GROUP_REJECT:202,RTC_GROUP_FAILED:203,RTC_GROUP_CANCEL:204,RTC_GROUP_QUIT:205,RTC_GROUP_INVITE:206,RTC_GROUP_JOIN:207,RTC_GROUP_OFFER:208,RTC_GROUP_ANSWER:209,RTC_GROUP_CANDIDATE:210,RTC_GROUP_DEVICE:211},Ye={FREE:0,WAIT_CALL:1,WAIT_ACCEPT:2,ACCEPTED:3,CHATING:4},ze={WEB:0,APP:1},Je={UNSEND:0,SENDED:1,RECALL:2,READED:3};var Ze={state:{userInfo:{}},mutations:{setUserInfo(e,t){e.userInfo=t},clear(e){e.userInfo={}}},actions:{loadUser(e){return new Promise((t,s)=>{me({url:"/user/self",method:"GET"}).then(s=>{e.commit("setUserInfo",s),t()}).catch(e=>{s(e)})})}}},Ve=s("a002"),Ke=s.n(Ve);let qe=[];var Xe={state:{activeChat:null,privateMsgMaxId:0,groupMsgMaxId:0,loadingPrivateMsg:!1,loadingGroupMsg:!1,chats:[]},mutations:{initChats(e,t){e.chats=[],e.privateMsgMaxId=t.privateMsgMaxId||0,e.groupMsgMaxId=t.groupMsgMaxId||0,qe=t.chats||[],qe.forEach(e=>{e.messages.forEach(e=>{"loading"==e.loadStatus&&(e.loadStatus="fail")})})},openChat(e,t){let s=this.getters.findChats(),i=null;for(let o in s)if(s[o].type==t.type&&s[o].targetId===t.targetId){i=s[o],this.commit("moveTop",o);break}null==i&&(i={targetId:t.targetId,type:t.type,showName:t.showName,headImage:t.headImage,lastContent:"",lastSendTime:(new Date).getTime(),unreadCount:0,messages:[],atMe:!1,atAll:!1,stored:!1,delete:!1},s.unshift(i))},activeChat(e,t){let s=this.getters.findChats();e.activeChat=s[t]},resetUnreadCount(e,t){let s=this.getters.findChats();for(let i in s)if(s[i].type==t.type&&s[i].targetId==t.targetId){s[i].unreadCount=0,s[i].atMe=!1,s[i].atAll=!1,s[i].stored=!1,this.commit("saveToStorage");break}},readedMessage(e,t){let s=this.getters.findChatByFriend(t.friendId);s&&(s.messages.forEach(e=>{e.id&&e.selfSend&&e.status<Je.RECALL&&(!t.maxId||e.id<=t.maxId)&&(e.status=Je.READED,s.stored=!1)}),this.commit("saveToStorage"))},removeChat(e,t){let s=this.getters.findChats();s[t]==e.activeChat&&(e.activeChat=null),s[t].delete=!0,s[t].stored=!1,this.commit("saveToStorage")},removePrivateChat(e,t){let s=this.getters.findChats();for(let i in s)if("PRIVATE"==s[i].type&&s[i].targetId===t){this.commit("removeChat",i);break}},removeGroupChat(e,t){let s=this.getters.findChats();for(let i in s)if("GROUP"==s[i].type&&s[i].targetId===t){this.commit("removeChat",i);break}},moveTop(e,t){if(!this.getters.isLoading()&&t>0){let e=this.getters.findChats(),s=e[t];e.splice(t,1),e.unshift(s),s.lastSendTime=(new Date).getTime(),s.stored=!1,this.commit("saveToStorage")}},insertMessage(e,[t,s]){let i=s.type;t.id&&"PRIVATE"==i&&t.id>e.privateMsgMaxId&&(e.privateMsgMaxId=t.id),t.id&&"GROUP"==i&&t.id>e.groupMsgMaxId&&(e.groupMsgMaxId=t.id);let o=this.getters.findChat(s),n=this.getters.findMessage(o,t);if(n)return Object.assign(n,t),o.stored=!1,void this.commit("saveToStorage");if(t.type==Qe.IMAGE?o.lastContent="[图片]":t.type==Qe.FILE?o.lastContent="[文件]":t.type==Qe.AUDIO?o.lastContent="[语音]":t.type==Qe.ACT_RT_VOICE?o.lastContent="[语音通话]":t.type==Qe.ACT_RT_VIDEO?o.lastContent="[视频通话]":t.type!=Qe.TEXT&&t.type!=Qe.RECALL&&t.type!=Qe.TIP_TEXT&&t.type!=Qe.SENTEXT||(o.lastContent=t.content),o.lastSendTime=t.sendTime,o.sendNickName=t.sendNickName,t.selfSend||t.status==Je.READED||t.status==Je.RECALL||t.type==Qe.TIP_TEXT||o.unreadCount++,!t.selfSend&&"GROUP"==o.type&&t.atUserIds&&t.status!=Je.READED){let e=Ze.state.userInfo.id;t.atUserIds.indexOf(e)>=0&&(o.atMe=!0),t.atUserIds.indexOf(-1)>=0&&(o.atAll=!0)}(!o.lastTimeTip||o.lastTimeTip<t.sendTime-6e5)&&(o.messages.push({sendTime:t.sendTime,type:Qe.TIP_TIME}),o.lastTimeTip=t.sendTime);let a=o.messages.length;if(t.id&&t.id>0)for(let r in o.messages)if(o.messages[r].id&&t.id<o.messages[r].id){a=r,console.log(`消息出现乱序,位置:${o.messages.length},修正至:${a}`);break}o.messages.splice(a,0,t),o.stored=!1,this.commit("saveToStorage")},updateMessage(e,[t,s]){let i=this.getters.findChat(s),o=this.getters.findMessage(i,t);o&&(Object.assign(o,t),i.stored=!1,this.commit("saveToStorage"))},deleteMessage(e,[t,s]){let i=this.getters.findChat(s);for(let o in i.messages){if(i.messages[o].id&&i.messages[o].id==t.id){i.messages.splice(o,1);break}if(i.messages[o].tmpId&&i.messages[o].tmpId==t.tmpId){i.messages.splice(o,1);break}}i.stored=!1,this.commit("saveToStorage")},recallMessage(e,[t,s]){let i=this.getters.findChat(s);if(!i)return;let o=t.content,n=t.selfSend?"你":"PRIVATE"==i.type?"对方":t.sendNickName;for(let a in i.messages){let e=i.messages[a];e.id&&e.id==o&&(e.status=Je.RECALL,e.content=n+"撤回了一条消息",t.type===Qe.ADMINRC&&(e.content="管理员撤回了一条成员消息"),e.type=Qe.TIP_TEXT,i.lastContent=e.content,i.lastSendTime=t.sendTime,i.sendNickName="",t.selfSend||t.status==Je.READED||i.unreadCount++),e.quoteMessage&&e.quoteMessage.id==t.id&&(e.quoteMessage.content="引用内容已撤回",e.quoteMessage.status=Je.RECALL,e.quoteMessage.type=Qe.TIP_TEXT)}i.stored=!1,this.commit("saveToStorage")},updateChatFromFriend(e,t){let s=this.getters.findChatByFriend(t.id);!s||s.headImage==t.headImage&&s.showName==t.nickName||(s.headImage=t.headImage,s.showName=t.nickName,s.stored=!1,this.commit("saveToStorage"))},updateChatFromUser(e){let t=this.getters.findChatByFriend(e.id);!t||t.headImage==e.headImageThumb&&t.showName==e.nickName||(t.headImage=e.headImageThumb,t.showName=e.nickName,t.stored=!1,this.saveToStorage())},updateChatFromGroup(e,t){let s=this.getters.findChatByGroup(t.id);!s||s.headImage==t.headImageThumb&&s.showName==t.showGroupName||(s.headImage=t.headImageThumb,s.showName=t.showGroupName,s.stored=!1,this.commit("saveToStorage"))},loadingPrivateMsg(e,t){e.loadingPrivateMsg=t,this.getters.isLoading()||this.commit("refreshChats")},loadingGroupMsg(e,t){e.loadingGroupMsg=t,this.getters.isLoading()||this.commit("refreshChats")},refreshChats(e){qe&&(qe.sort((e,t)=>t.lastSendTime-e.lastSendTime),e.chats=qe,qe=null,this.commit("saveToStorage"))},saveToStorage(e){if(this.getters.isLoading())return;let t=Ze.state.userInfo.id,s="chats-"+t,i=[];e.chats.forEach(e=>{let t=`${s}-${e.type}-${e.targetId}`;e.stored||(e.delete?Ke.a.removeItem(t):Ke.a.setItem(t,e),e.stored=!0),e.delete||i.push(t)});let o={privateMsgMaxId:e.privateMsgMaxId,groupMsgMaxId:e.groupMsgMaxId,chatKeys:i};Ke.a.setItem(s,o),e.chats=e.chats.filter(e=>!e.delete)},clear(e){qe=[],e.chats=[],e.activeChat=null}},actions:{loadChat(e){return new Promise((t,s)=>{let i=Ze.state.userInfo.id,o="chats-"+i;Ke.a.getItem(o).then(s=>{if(s){if(s.chats)e.commit("initChats",s),t();else if(s.chatKeys){const i=[];s.chatKeys.forEach(e=>{i.push(Ke.a.getItem(e))}),Promise.all(i).then(i=>{s.chats=i.filter(e=>e),e.commit("initChats",s),t()})}}else t()}).catch(e=>{console.log("加载消息失败"),s()})})}},getters:{isLoading:e=>()=>e.loadingPrivateMsg||e.loadingGroupMsg,findChats:(e,t)=>()=>qe&&t.isLoading()?qe:e.chats,findChatIdx:(e,t)=>e=>{let s=t.findChats();for(let t in s)if(s[t].type==e.type&&s[t].targetId===e.targetId)return e=s[t],t},findChat:(e,t)=>e=>{let s=t.findChats(),i=t.findChatIdx(e);return s[i]},findChatByFriend:(e,t)=>e=>{let s=t.findChats();return s.find(t=>"PRIVATE"==t.type&&t.targetId==e)},findChatByGroup:(e,t)=>e=>{let s=t.findChats();return s.find(t=>"GROUP"==t.type&&t.targetId==e)},findMessage:e=>(e,t)=>{if(!e)return null;for(let s in e.messages){if(t.id&&e.messages[s].id==t.id)return e.messages[s];if(t.tmpId&&e.messages[s].tmpId&&e.messages[s].tmpId==t.tmpId)return e.messages[s]}}}},et=(s("a573"),{state:{friends:[],timer:null},mutations:{setFriends(e,t){t.forEach(e=>{e.online=!1,e.onlineWeb=!1,e.onlineApp=!1}),e.friends=t},updateFriend(e,t){e.friends.forEach((s,i)=>{if(s.id==t.id){let s=e.friends[i].online;Object.assign(e.friends[i],t),e.friends[i].online=s}})},removeFriend(e,t){e.friends.filter(e=>e.id==t).forEach(e=>e.deleted=!0)},addFriend(e,t){e.friends.some(e=>e.id==t.id)?this.commit("updateFriend",t):e.friends.unshift(t)},refreshOnlineStatus(e){let t=e.friends.filter(e=>!e.deleted).map(e=>e.id);0!=t.length&&(me({url:"/user/terminal/online",method:"get",params:{userIds:t.join(",")}}).then(e=>{this.commit("setOnlineStatus",e)}),e.timer&&clearTimeout(e.timer),e.timer=setTimeout(()=>{this.commit("refreshOnlineStatus")},3e4))},setOnlineStatus(e,t){e.friends.forEach(e=>{let s=t.find(t=>e.id==t.userId);s?(e.online=!0,e.onlineWeb=s.terminals.indexOf(ze.WEB)>=0,e.onlineApp=s.terminals.indexOf(ze.APP)>=0):(e.online=!1,e.onlineWeb=!1,e.onlineApp=!1)}),e.friends.sort((e,t)=>e.online&&!t.online?-1:t.online&&!e.online?1:0)},clear(e){e.timer&&clearTimeout(e.timer),e.friends=[],e.timer=null}},actions:{loadFriend(e){return new Promise((t,s)=>{me({url:"/friend/list",method:"GET"}).then(s=>{e.commit("setFriends",s),e.commit("refreshOnlineStatus"),t()}).catch(()=>{s()})})}},getters:{isFriend:e=>t=>e.friends.filter(e=>!e.deleted).some(e=>e.id==t),findFriend:e=>t=>e.friends.find(e=>e.id==t)}}),tt={state:{groups:[]},mutations:{setGroups(e,t){e.groups=t},addGroup(e,t){e.groups.some(e=>e.id==t.id)?this.commit("updateGroup",t):e.groups.unshift(t)},removeGroup(e,t){e.groups.filter(e=>e.id==t).forEach(e=>e.quit=!0)},updateGroup(e,t){e.groups.forEach((s,i)=>{s.id==t.id&&Object.assign(e.groups[i],t)})},clear(e){e.groups=[]}},actions:{loadGroup(e){return new Promise((t,s)=>{me({url:"/group/list",method:"GET"}).then(s=>{e.commit("setGroups",s),t()}).catch(e=>{s(e)})})}},getters:{findGroup:e=>t=>e.groups.find(e=>e.id==t)}},st={state:{userInfo:{show:!1,user:{},pos:{x:0,y:0}},fullImage:{show:!1,url:""}},mutations:{showUserInfoBox(e,t){e.userInfo.show=!0,e.userInfo.user=t},setUserInfoBoxPos(e,t){let s=document.documentElement.clientWidth,i=document.documentElement.clientHeight;e.userInfo.pos.x=Math.min(t.x,s-350),e.userInfo.pos.y=Math.min(t.y,i-200)},closeUserInfoBox(e){e.userInfo.show=!1},showFullImageBox(e,t){e.fullImage.show=!0,e.fullImage.url=t},closeFullImageBox(e){e.fullImage.show=!1}}};r["default"].use(We["a"]);var it=new We["a"].Store({modules:{chatStore:Xe,friendStore:et,userStore:Ze,groupStore:tt,uiStore:st},state:{},mutations:{},actions:{load(e){return this.dispatch("loadUser").then(()=>{const e=[];return e.push(this.dispatch("loadFriend")),e.push(this.dispatch("loadGroup")),e.push(this.dispatch("loadChat")),Promise.all(e)})},unload(e){e.commit("clear")}},strict:!1});let ot=(e,t)=>{var s=new Date(e),i=Date.parse(new Date),o=i-s,n="";return o<=6e4?n="刚刚":o>6e4&&o<36e5?n=Math.floor(o/6e4)+"分钟前":o>=36e5&&o<864e5&&!nt(s)?n=rt(s).substr(11,5):nt(s)?n="昨天"+rt(s).substr(11,5):at(s)?n=rt(s).substr(5,t?5:14):(n=rt(s),t&&(n=n.substr(2,8))),n},nt=e=>{var t=new Date(new Date-864e5);return t.getYear()===e.getYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},at=e=>e.getYear()===(new Date).getYear(),rt=e=>{if(""===e||!e)return"";var t=new Date(e),s=t.getFullYear(),i=t.getMonth()+1;i=i<10?"0"+i:i;var o=t.getDate();o=o<10?"0"+o:o;var n=t.getHours();n=n<10?"0"+n:n;var a=t.getMinutes();a=a<10?"0"+a:a;var r=t.getSeconds();return r=r<10?"0"+r:r,s+"/"+i+"/"+o+" "+n+":"+a+":"+r};r["default"].directive("dialogDrag",{bind(e,t,s,i){const o=e.querySelector(".el-dialog__header"),n=e.querySelector(".el-dialog");o.style.cursor="move";const a=n.currentStyle||window.getComputedStyle(n,null);o.onmousedown=e=>{const t=e.clientX-o.offsetLeft,s=e.clientY-o.offsetTop,i=document.body.clientWidth,r=document.documentElement.clientHeight,l=n.offsetWidth,c=n.offsetHeight,u=n.offsetLeft,d=i-n.offsetLeft-l,m=n.offsetTop,f=r-n.offsetTop-c;let p,h;a.left.includes("%")?(p=+document.body.clientWidth*(+a.left.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+a.top.replace(/\%/g,"")/100)):(p=+a.left.replace(/\px/g,""),h=+a.top.replace(/\px/g,"")),document.onmousemove=function(e){var i=e.clientX-t,o=e.clientY-s;-i>u?i=-u:i>d&&(i=d),-o>m?o=-m:o>f&&(o=f),n.style.left=i+p+"px",n.style.top=o+h+"px"},document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null}}}}),r["default"].use(ce.a),r["default"].prototype.$wsApi=i,r["default"].prototype.$msgType=o,r["default"].prototype.$date=a,r["default"].prototype.$http=me,r["default"].prototype.$emo=$e,r["default"].prototype.$url=_e,r["default"].prototype.$elm=Be,r["default"].prototype.$enums=n,r["default"].prototype.$eventBus=new r["default"],r["default"].config.productionTip=!1,new r["default"]({el:"#app",router:re,store:it,render:e=>e(p)})},"5b62":function(e,t,s){e.exports=s.p+"img/logo.0e736107.png"},"5d59":function(e,t,s){},"5f40":function(e,t,s){e.exports=s.p+"img/21.ec8df612.gif"},6047:function(e,t,s){e.exports=s.p+"img/34.b4c0eba4.gif"},6178:function(e,t,s){},"61f2":function(e,t,s){e.exports=s.p+"img/48.20d1ce26.gif"},6318:function(e,t,s){e.exports=s.p+"img/28.52524722.gif"},"642d":function(e,t,s){var i={"./0.gif":"f1c0","./1.gif":"f320","./10.gif":"d054","./11.gif":"b1c1","./12.gif":"4518","./13.gif":"a79b","./14.gif":"982d","./15.gif":"6e1f","./16.gif":"50a5","./17.gif":"25a1","./18.gif":"fd6e","./19.gif":"32c6","./2.gif":"34cb","./20.gif":"d496","./21.gif":"5f40","./22.gif":"4fc8","./23.gif":"f5d6","./24.gif":"058c","./25.gif":"3854","./26.gif":"7a13","./27.gif":"36a4","./28.gif":"6318","./29.gif":"df98","./3.gif":"d370","./30.gif":"5541","./31.gif":"8bb4","./32.gif":"cd82","./33.gif":"8e89","./34.gif":"6047","./35.gif":"7e0f","./36.gif":"846c","./37.gif":"8959","./38.gif":"ba6e","./39.gif":"5347","./4.gif":"3dfc","./40.gif":"1a8f","./41.gif":"3d2d","./42.gif":"6430","./43.gif":"a4d0","./44.gif":"680b","./45.gif":"829b","./46.gif":"9aeb","./47.gif":"37bf","./48.gif":"61f2","./49.gif":"b59b","./5.gif":"28f3","./50.gif":"e715","./51.gif":"e0c4","./52.gif":"4d66","./53.gif":"7a4c","./54.gif":"7449","./55.gif":"9216","./56.gif":"e769","./6.gif":"81f6","./7.gif":"ef96","./8.gif":"0abc","./9.gif":"3f29"};function o(e){var t=n(e);return s(t)}function n(e){if(!s.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}o.keys=function(){return Object.keys(i)},o.resolve=n,e.exports=o,o.id="642d"},6430:function(e,t,s){e.exports=s.p+"img/42.02d062c5.gif"},6439:function(e,t,s){"use strict";s.d(t,"a",(function(){return i})),s.d(t,"b",(function(){return o}));var i=function(){var e=this;e._self._c,e._self._setupProxy;return e._m(0)},o=[function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"icp"},[t("img",{staticClass:"icp-icon",attrs:{src:s("8681")}}),t("a",{attrs:{target:"_blank",href:"https://beian.miit.gov.cn/"}},[e._v("粤ICP备xxxx号-1")])])}]},6585:function(e,t,s){},"680b":function(e,t,s){e.exports=s.p+"img/44.00ef8c19.gif"},"6c79":function(e,t,s){},"6e1f":function(e,t,s){e.exports=s.p+"img/15.75820281.gif"},"71a0":function(e,t,s){"use strict";s("6585")},"736a":function(e,t,s){},7449:function(e,t,s){e.exports=s.p+"img/54.2030cc4e.gif"},"7a13":function(e,t,s){e.exports=s.p+"img/26.03b7a469.gif"},"7a4c":function(e,t,s){e.exports=s.p+"img/53.a59af82b.gif"},"7e0f":function(e,t,s){e.exports=s.p+"img/35.7e9e390a.gif"},"81f6":function(e,t,s){e.exports=s.p+"img/6.187a4467.gif"},8240:function(e,t,s){},"829b":function(e,t,s){e.exports=s.p+"img/45.7bab77e0.gif"},"846c":function(e,t,s){e.exports=s.p+"img/36.c4e8fcb2.gif"},8681:function(e,t,s){e.exports=s.p+"img/icp_logo.58f55c5c.png"},8786:function(e,t,s){"use strict";s("736a")},8959:function(e,t,s){e.exports=s.p+"img/37.418a25ff.gif"},"8a1f":function(e,t,s){},"8bb4":function(e,t,s){e.exports=s.p+"img/31.4894333c.gif"},"8e89":function(e,t,s){e.exports=s.p+"img/33.deb9bb7e.gif"},"91f8":function(e,t,s){"use strict";var i=s("f84e"),o=s.n(i);t["default"]=o.a},9216:function(e,t,s){e.exports=s.p+"img/55.469289a4.gif"},"97db":function(e,t,s){"use strict";s("5d59")},"982d":function(e,t,s){e.exports=s.p+"img/14.8734eba5.gif"},"9aeb":function(e,t,s){e.exports=s.p+"img/46.e9ac968c.gif"},a4d0:function(e,t,s){e.exports=s.p+"img/43.62177cf1.gif"},a79b:function(e,t,s){e.exports=s.p+"img/13.aaebd091.gif"},adec:function(e,t,s){"use strict";s("8a1f")},b1c1:function(e,t,s){e.exports=s.p+"img/11.b0d85036.gif"},b2d8:function(e,t,s){"use strict";s("e60d")},b59b:function(e,t,s){e.exports=s.p+"img/49.c881faa6.gif"},b9ad:function(e,t,s){"use strict";s("6c79")},ba6e:function(e,t,s){e.exports=s.p+"img/38.8f1726b9.gif"},be35:function(e,t,s){},cd82:function(e,t,s){e.exports=s.p+"img/32.f35d7073.gif"},d054:function(e,t,s){e.exports=s.p+"img/10.d13dcac4.gif"},d370:function(e,t,s){e.exports=s.p+"img/3.7abec26c.gif"},d496:function(e,t,s){e.exports=s.p+"img/20.6428ddb3.gif"},df98:function(e,t,s){e.exports=s.p+"img/29.1659f59b.gif"},e0c4:function(e,t,s){e.exports=s.p+"img/51.5d136c53.gif"},e4d1:function(e,t,s){},e60d:function(e,t,s){},e715:function(e,t,s){e.exports=s.p+"img/50.7614f726.gif"},e769:function(e,t,s){e.exports=s.p+"img/56.33767a85.gif"},eada:function(e,t,s){"use strict";s("026b")},ebcd:function(e,t,s){"use strict";s("5234")},ef96:function(e,t,s){e.exports=s.p+"img/7.fb655c96.gif"},f1c0:function(e,t,s){e.exports=s.p+"img/0.23538cb7.gif"},f2b0:function(e,t,s){e.exports=s.p+"media/tip.7068643e.wav"},f320:function(e,t,s){e.exports=s.p+"img/1.41d8ebbe.gif"},f5d6:function(e,t,s){e.exports=s.p+"img/23.071999b8.gif"},f84e:function(e,t){},fd6e:function(e,t,s){e.exports=s.p+"img/18.c47c412d.gif"}});
//# sourceMappingURL=app.a822372b.js.map